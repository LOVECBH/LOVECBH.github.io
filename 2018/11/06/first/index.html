<!DOCTYPE html><html><head><meta name="generator" content="Hexo 3.8.0"><meta charset="utf-8"><meta content="yes" name="apple-mobile-web-app-capable"><meta content="yes" name="apple-touch-fullscreen"><meta content="telephone=no,email=no" name="format-detection"><meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no"><link rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon"><link href="https://fonts.googleapis.com/css?family=Rubik" rel="stylesheet"><script src="https://use.fontawesome.com/adaf0e149c.js"></script><link rel="stylesheet" href="https://cdn.bootcss.com/highlight.js/9.6.0/styles/monokai_sublime.min.css"><link rel="stylesheet" href="/css/index.css"><link rel="stylesheet" href="/css/post.css"><link rel="stylesheet" href="/css/markdown-github.css"><title>CC Learn Econometrics</title><script src="/js/googleAnalytics.js"></script></head><body><div id="postContainer"><div id="postTop"><h4 id="logo">你的男孩 CC</h4><br><br><h2 id="postTitle">STATA—内生变量的处理（工具变量法）</h2><br><span aria-hidden="true" class="postTime fa fa-calendar">2018-11-6</span><br><br></div><section id="articleDiv"><h4 id="本文使用简单线性回归模型：-Y-alpha-beta-X-u"><a href="#本文使用简单线性回归模型：-Y-alpha-beta-X-u" class="headerlink" title="本文使用简单线性回归模型：$Y=\alpha+\beta X+u$"></a>本文使用简单线性回归模型：$Y=\alpha+\beta X+u$</h4><p>当解释变量$X$和扰动项$u$相关时，该解释变量$X$被称为内生变量，此时CLRM假定的严格外生性得不到满足，OLS不再是BLUE<br>$$<br>Cov(X,u)\ne0<br>$$<br>但是如果能将内生变量分为两部分：一部分和扰动项相关，另一部分和扰动项不相关，那么就可以用和扰动项不相关的那部分得到一致估计。</p><br><hr><br><h2 id="1、工具变量法"><a href="#1、工具变量法" class="headerlink" title="1、工具变量法"></a>1、工具变量法</h2><h4 id="为了分离内生变量，引入工具变量-Z-："><a href="#为了分离内生变量，引入工具变量-Z-：" class="headerlink" title="为了分离内生变量，引入工具变量$Z$："></a>为了分离内生变量，引入工具变量$Z$：</h4><p>$$<br>X=\lambda_0+\lambda_1 Z+w<br>$$</p><br><h4 id="有效的工具变量需要满足以下条件："><a href="#有效的工具变量需要满足以下条件：" class="headerlink" title="有效的工具变量需要满足以下条件："></a>有效的工具变量需要满足以下条件：</h4><p>相关性：工具变量与内生变量相关<br>$$<br>Cov(Z,X)\ne0<br>$$</p><br><p>外生性：工具变量与扰动项不相关<br>$$<br>Cov(Z,u)=0<br>$$</p><br><h2 id="2、二阶段最小二乘法（2SLS"><a href="#2、二阶段最小二乘法（2SLS" class="headerlink" title="2、二阶段最小二乘法（2SLS)"></a>2、二阶段最小二乘法（2SLS)</h2><p>工具变量法一般用“二阶段最小二乘法”来实现，顾名思义，该方法通过两个阶段的回归来完成。</p><br><h4 id="第一阶段回归：用内生变量-X-对工具变量-Z-回归，消除扰动项-w-："><a href="#第一阶段回归：用内生变量-X-对工具变量-Z-回归，消除扰动项-w-：" class="headerlink" title="第一阶段回归：用内生变量$X$对工具变量$Z$回归，消除扰动项$w$："></a>第一阶段回归：用内生变量$X$对工具变量$Z$回归，消除扰动项$w$：</h4><p>$$<br>X=\lambda_0+\lambda_1 Z+w\longrightarrow \hat{X}=\hat{\lambda_0}+\hat{\lambda_1}Z<br>$$</p><br><h4 id="第二阶段回归：用被解释变量-Y-对第一阶段回归的拟合值-hat-X-进行回归。"><a href="#第二阶段回归：用被解释变量-Y-对第一阶段回归的拟合值-hat-X-进行回归。" class="headerlink" title="第二阶段回归：用被解释变量$Y$对第一阶段回归的拟合值$\hat{X}$进行回归。"></a>第二阶段回归：用被解释变量$Y$对第一阶段回归的拟合值$\hat{X}$进行回归。</h4><p>我们来看一下第二阶段回归的过程，回归方程可以这样写：$Y=\alpha+\beta \hat{X} +\beta (X-\hat{X})+u$</p><br><p>容易看出，这是由$Y=\alpha+\beta X+u$变形得来的，其扰动项$\varepsilon=\beta (X-\hat{X})+u$</p><br><p>接下来分析$\hat{X}$与$\varepsilon$的相关性：<br>$$<br>Cov(\hat{X},\varepsilon)=Cov(\hat{X},u)+\beta Cov(\hat{X},X-\hat{X})<br>$$<br>首先，由于$\hat{X}$是$Z$的线性函数，而$Cov(Z,u)=0$（工具变量的外生性），故$Cov(\hat{X},u)=0$</p><br><p>其次，拟合值$\hat{X}$与残差$X-\hat{X}$正交（OLS的正交性），故$Cov(\hat{X},X-\hat{X})=0$</p><br><p>最后，得到结论：第二阶段回归的解释变量$\hat{X}$与扰动项$\varepsilon$不相关，故2SLS一致。</p><br><h4 id="从以上分析可以看出，2SLS的实质：把内生变量-X-分为两部分，由工具变量-Z-造成的外生部分-hat-X-，以及与扰动项-u-相关的其余部分-X-hat-X-。"><a href="#从以上分析可以看出，2SLS的实质：把内生变量-X-分为两部分，由工具变量-Z-造成的外生部分-hat-X-，以及与扰动项-u-相关的其余部分-X-hat-X-。" class="headerlink" title="从以上分析可以看出，2SLS的实质：把内生变量$X$分为两部分，由工具变量$Z$造成的外生部分$\hat{X}$，以及与扰动项$u$相关的其余部分$X-\hat{X}$。"></a>从以上分析可以看出，2SLS的实质：把内生变量$X$分为两部分，由工具变量$Z$造成的外生部分$\hat{X}$，以及与扰动项$u$相关的其余部分$X-\hat{X}$。</h4><h2 id="3、GMM（广义矩估计）"><a href="#3、GMM（广义矩估计）" class="headerlink" title="3、GMM（广义矩估计）"></a>3、GMM（广义矩估计）</h2><p>在球形扰动项（扰动项满足”同方差“、“无自相关”性质）的假定下，2SLS是最有效率的，但如果扰动项存在异方差或自相关，那么GMM是相对于2SLS更有效的方法。</p><br><p>But,我还没有想好怎么言简意骇的来解释书上GMM的复杂证明…</p><br><p>So,以后有思路了再讲好伐..</p><br><h2 id="4、豪斯曼检验（检验解释变量的内生性）"><a href="#4、豪斯曼检验（检验解释变量的内生性）" class="headerlink" title="4、豪斯曼检验（检验解释变量的内生性）"></a>4、豪斯曼检验（检验解释变量的内生性）</h2><p>使用工具变量法是有前提的，即存在内生变量。</p><br><p>那么如何检验变量是否为内生呢？</p><br><p>“豪斯曼检验”的原假设为“$H_0$：所有解释变量均为外生变量”。</p><br><p>如果$H_0$成立，则OLS与IV（工具变量法）都一致，在大样本下$\hat{\beta_{IV}}$与$\hat{\beta_{OLS}}$都收敛于真实的参数$\beta$。</p><br><p>反之，如果$H_0$不成立，则IV一致而OLS不一致。</p><br><p>但是，豪斯曼检验有缺点：不适用异方差的情形，但是经过改进的Durbin-Wu-Hausman tesx 即DWH检验即使在异方差的情况下也适用</p><br><h2 id="5、如何获得工具变量"><a href="#5、如何获得工具变量" class="headerlink" title="5、如何获得工具变量"></a>5、如何获得工具变量</h2><h4 id="1、列出与内生解释变量相关的尽可能多的变量清单（这一步较容易）"><a href="#1、列出与内生解释变量相关的尽可能多的变量清单（这一步较容易）" class="headerlink" title="1、列出与内生解释变量相关的尽可能多的变量清单（这一步较容易）"></a>1、列出与内生解释变量相关的尽可能多的变量清单（这一步较容易）</h4><h4 id="2、从清单中剔除与扰动项相关的变量（这一步较难）"><a href="#2、从清单中剔除与扰动项相关的变量（这一步较难）" class="headerlink" title="2、从清单中剔除与扰动项相关的变量（这一步较难）"></a>2、从清单中剔除与扰动项相关的变量（这一步较难）</h4><p>下面举一个应用工具变量法的很好地案例：警察人数与犯罪率</p><br><p>一般认为，警察人数越多，执法力度越大，则犯罪率应该越低。然而，如果直接把犯罪率对警察人数进行回归，以此度量警察人数对犯罪率的作用，就会出现内生变量偏差。这是因为警察人数其实是内生变量，比如，某城市的犯罪率很高，则市政府通常会增加警察人数。为此必须找到与警察人数相关，但对犯罪率没有其他影响渠道的工具变量。Levitt(1997)创造性地使用“市场选举的政治周期”作为犯罪率的工具变量。通常，在任市长在竞选连任时，为了拉选票，会增加警察人数，故满足相关性。另一方面，选举周期一般以机械的方式确定，除了对警察人数有影响外，不会单独地对犯罪率起作用，故满足外生性。</p><br><p>（PS:在人大论坛看到这样一句话，如果能选到合适的工具变量，那么从MIT博士毕业都没问题了，Emmm…有机会的话去MIT验证一下，哈哈哈）</p><br><hr><br><h4 id="写在文尾的话：我写博客的目的一方面是记录自己的学习历程，另一方面是想把自己对书上的思考分享给大家，计量的书既大又厚，里面的公式推导复杂又难懂，我追求能用比较简洁明了的方法去理解计量，那么就让我们一起好好学习，天天向上吧！"><a href="#写在文尾的话：我写博客的目的一方面是记录自己的学习历程，另一方面是想把自己对书上的思考分享给大家，计量的书既大又厚，里面的公式推导复杂又难懂，我追求能用比较简洁明了的方法去理解计量，那么就让我们一起好好学习，天天向上吧！" class="headerlink" title="写在文尾的话：我写博客的目的一方面是记录自己的学习历程，另一方面是想把自己对书上的思考分享给大家，计量的书既大又厚，里面的公式推导复杂又难懂，我追求能用比较简洁明了的方法去理解计量，那么就让我们一起好好学习，天天向上吧！"></a>写在文尾的话：我写博客的目的一方面是记录自己的学习历程，另一方面是想把自己对书上的思考分享给大家，计量的书既大又厚，里面的公式推导复杂又难懂，我追求能用比较简洁明了的方法去理解计量，那么就让我们一起好好学习，天天向上吧！</h4></section></div><script src="/js/jquery.min.js"></script><script src="/js/highlight.min.js"></script><script src="/js/start.js"></script><script src="/live2dw/lib/L2Dwidget.min.js?0c58a1486de42ac6cc1c59c7d98ae887"></script><script>L2Dwidget.init({"log":false,"pluginJsPath":"lib/","pluginModelPath":"assets/","pluginRootPath":"live2dw/","tagMode":false});</script></body></html>