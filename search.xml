<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>2SLS——内生变量的处理（工具变量法）</title>
      <link href="/2018/11/06/first/"/>
      <url>/2018/11/06/first/</url>
      
        <content type="html"><![CDATA[<blockquote><p>本文使用简单线性回归模型：$Y=\alpha+\beta X+u$</p></blockquote><p>当解释变量$X$和扰动项$u$相关时，该解释变量$X$被称为内生变量，此时CLRM假定的严格外生性得不到满足，OLS不再是BLUE$$Cov(X,u)\ne0$$但是如果能将内生变量分为两部分：一部分和扰动项相关，另一部分和扰动项不相关，那么就可以用和扰动项不相关的那部分得到一致估计。</p><hr><h2>1、工具变量法</h2><blockquote><p>为了分离内生变量，引入工具变量$Z$：</p></blockquote><p>$$Y=\alpha+\beta X+\gamma Z+\delta$$</p><blockquote><p>有效的工具变量需要满足以下条件：</p></blockquote><p>相关性：工具变量与内生变量相关$$Cov(Z,X)\ne0$$</p><p>外生性：工具变量与扰动项不相关$$Cov(Z,u)=0$$</p><h2>2、二阶段最小二乘法（2SLS)</h2><p>工具变量法一般用“二阶段最小二乘法”来实现，顾名思义，该方法通过两个阶段的回归来完成。</p><blockquote><p>第一阶段回归：用内生变量$X$对工具变量$Z$回归，消除扰动项$w$：</p></blockquote><p>$$X=\lambda_0+\lambda_1 Z+w\longrightarrow \hat{X}=\hat{\lambda_0}+\hat{\lambda_1}Z$$</p><blockquote><p>第二阶段回归：用被解释变量$Y$对第一阶段回归的拟合值$\hat{X}$进行回归。</p></blockquote><p>我们来看一下第二阶段回归的过程，回归方程可以这样写：$Y=\alpha+\beta \hat{X} +\beta (X-\hat{X})+u$</p><p>容易看出，这是由$Y=\alpha+\beta X+u$变形得来的，其扰动项$\varepsilon=\beta (X-\hat{X})+u$</p><p>接下来分析$\hat{X}$与$\varepsilon$的相关性：$$Cov(\hat{X},\varepsilon)=Cov(\hat{X},u)+\beta Cov(\hat{X},X-\hat{X})$$首先，由于$\hat{X}$是$Z$的线性函数，而$Cov(Z,u)=0$（工具变量的外生性），故$Cov(\hat{X},u)=0$</p><p>其次，拟合值$\hat{X}$与残差$X-\hat{X}$正交（OLS的正交性），故$Cov(\hat{X},X-\hat{X})=0$</p><p>最后，得到结论：第二阶段回归的解释变量$\hat{X}$与扰动项$\varepsilon$不相关，故2SLS一致。</p><blockquote><p>从以上分析可以看出，2SLS的实质：把内生变量$X$分为两部分，由工具变量$Z$造成的外生部分$\hat{X}$，以及与扰动项$u$相关的其余部分$X-\hat{X}$。</p></blockquote><h2>3、上课补充</h2><p>1、内生性有三种：</p><blockquote><p>遗失变量</p></blockquote><blockquote><p>反向因果</p></blockquote><blockquote><p>测量误差</p></blockquote><p>前两种很常见，第三种很少考虑。</p><p>2、自变量分为：</p><blockquote><p>核心变量</p></blockquote><blockquote><p>控制变量</p></blockquote><p>控制变量的作用是为了保证核心变量估计的一致性，核心变量最重要。</p><p>3、分离的是扰动项，不是内生变量。</p><hr>]]></content>
      
      
      
    </entry>
    
  
  
</search>
