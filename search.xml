<?xml version="1.0" encoding="utf-8"?>
<search> 
  
    
    <entry>
      <title>STATA—内生变量的处理（工具变量法）</title>
      <link href="/2018/11/06/first/"/>
      <url>/2018/11/06/first/</url>
      
        <content type="html"><![CDATA[<blockquote><p>本文使用简单线性回归模型：$Y=\alpha+\beta X+u$</p></blockquote><p>当解释变量$X$和扰动项$u$相关时，该解释变量$X$被称为内生变量，此时CLRM假定的严格外生性得不到满足，OLS不再是BLUE$$Cov(X,u)\ne0$$但是如果能将内生变量分为两部分：一部分和扰动项相关，另一部分和扰动项不相关，那么就可以用和扰动项不相关的那部分得到一致估计。</p><hr><h2>1、工具变量法</h2><blockquote><p>为了分离内生变量，引入工具变量$Z$：</p></blockquote><p>$$X=\lambda_0+\lambda_1 Z+w$$</p><blockquote><p>有效的工具变量需要满足以下条件：</p></blockquote><p>相关性：工具变量与内生变量相关$$Cov(Z,X)\ne0$$</p><p>外生性：工具变量与扰动项不相关$$Cov(Z,u)=0$$</p><h2>2、二阶段最小二乘法（2SLS)</h2><p>工具变量法一般用“二阶段最小二乘法”来实现，顾名思义，该方法通过两个阶段的回归来完成。</p><blockquote><p>第一阶段回归：用内生变量$X$对工具变量$Z$回归，消除扰动项$w$：</p></blockquote><p>$$X=\lambda_0+\lambda_1 Z+w\longrightarrow \hat{X}=\hat{\lambda_0}+\hat{\lambda_1}Z$$</p><blockquote><p>第二阶段回归：用被解释变量$Y$对第一阶段回归的拟合值$\hat{X}$进行回归。</p></blockquote><p>我们来看一下第二阶段回归的过程，回归方程可以这样写：$Y=\alpha+\beta \hat{X} +\beta (X-\hat{X})+u$</p><p>容易看出，这是由$Y=\alpha+\beta X+u$变形得来的，其扰动项$\varepsilon=\beta (X-\hat{X})+u$</p><p>接下来分析$\hat{X}$与$\varepsilon$的相关性：$$Cov(\hat{X},\varepsilon)=Cov(\hat{X},u)+\beta Cov(\hat{X},X-\hat{X})$$首先，由于$\hat{X}$是$Z$的线性函数，而$Cov(Z,u)=0$（工具变量的外生性），故$Cov(\hat{X},u)=0$</p><p>其次，拟合值$\hat{X}$与残差$X-\hat{X}$正交（OLS的正交性），故$Cov(\hat{X},X-\hat{X})=0$</p><p>最后，得到结论：第二阶段回归的解释变量$\hat{X}$与扰动项$\varepsilon$不相关，故2SLS一致。</p><blockquote><p>从以上分析可以看出，2SLS的实质：把内生变量$X$分为两部分，由工具变量$Z$造成的外生部分$\hat{X}$，以及与扰动项$u$相关的其余部分$X-\hat{X}$。</p></blockquote><h2>3、GMM（广义矩估计）</h2><p>在球形扰动项（扰动项满足”同方差“、“无自相关”性质）的假定下，2SLS是最有效率的，但如果扰动项存在异方差或自相关，那么GMM是相对于2SLS更有效的方法。</p><p>But,我还没有想好怎么言简意骇的来解释书上GMM的复杂证明...</p><p>So,以后有思路了再讲好伐..</p><h2>4、豪斯曼检验（检验解释变量的内生性）</h2><p>使用工具变量法是有前提的，即存在内生变量。</p><p>那么如何检验变量是否为内生呢？</p><p>“豪斯曼检验”的原假设为“$H_0$：所有解释变量均为外生变量”。</p><p>如果$H_0$成立，则OLS与IV（工具变量法）都一致，在大样本下$\hat{\beta_{IV}}$与$\hat{\beta_{OLS}}$都收敛于真实的参数$\beta$。</p><p>反之，如果$H_0$不成立，则IV一致而OLS不一致。</p><p>但是，豪斯曼检验有缺点：不适用异方差的情形，但是经过改进的Durbin-Wu-Hausman tesx 即DWH检验即使在异方差的情况下也适用</p><h2>5、如何获得工具变量</h2><blockquote><p>1、列出与内生解释变量相关的尽可能多的变量清单（这一步较容易）</p></blockquote><blockquote><p>2、从清单中剔除与扰动项相关的变量（这一步较难）</p></blockquote><p>下面举一个应用工具变量法的很好地案例：警察人数与犯罪率</p><p>一般认为，警察人数越多，执法力度越大，则犯罪率应该越低。然而，如果直接把犯罪率对警察人数进行回归，以此度量警察人数对犯罪率的作用，就会出现内生变量偏差。这是因为警察人数其实是内生变量，比如，某城市的犯罪率很高，则市政府通常会增加警察人数。为此必须找到与警察人数相关，但对犯罪率没有其他影响渠道的工具变量。Levitt(1997)创造性地使用“市场选举的政治周期”作为犯罪率的工具变量。通常，在任市长在竞选连任时，为了拉选票，会增加警察人数，故满足相关性。另一方面，选举周期一般以机械的方式确定，除了对警察人数有影响外，不会单独地对犯罪率起作用，故满足外生性。</p><p>（PS:在人大论坛看到这样一句话，如果能选到合适的工具变量，那么从MIT博士毕业都没问题了，Emmm...有机会的话去MIT验证一下，哈哈哈）</p><hr><blockquote><p>写在文尾的话：我写博客的目的一方面是记录自己的学习历程，另一方面是想把自己对书上的思考分享给大家，计量的书既大又厚，里面的公式推导复杂又难懂，我追求能用比较简洁明了的方法去理解计量，那么就让我们一起好好学习，天天向上吧!</p></blockquote>]]></content>
      
      
      
    </entry>
    
  
  
</search>
